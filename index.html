<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema CAS-DF COMPLETO - Definitivo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2.2em; margin-bottom: 10px; }
        .content { padding: 40px; }
        .form-section { margin-bottom: 40px; padding: 25px; border: 2px solid #e1e8ed; border-radius: 15px; background: #f8fafc; }
        .form-section h3 { color: #2d3748; margin-bottom: 20px; font-size: 1.4em; border-bottom: 3px solid #667eea; padding-bottom: 10px; }
        .form-group { margin-bottom: 20px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #4a5568; }
        input, select, textarea { width: 100%; padding: 12px 15px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 16px; transition: all 0.3s ease; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
        .btn { padding: 15px 30px; border: none; border-radius: 25px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.2); }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .btn-secondary { background: #e2e8f0; color: #4a5568; }
        .btn-success { background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); color: white; }
        .btn-danger { background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%); color: white; }
        .action-buttons { display: flex; gap: 15px; justify-content: center; margin-top: 40px; flex-wrap: wrap; }
        .checkbox-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin-top: 15px; }
        .checkbox-item { display: flex; align-items: flex-start; padding: 12px; background: white; border: 2px solid #e2e8f0; border-radius: 10px; }
        .checkbox-item input { width: auto; margin-right: 10px; transform: scale(1.2); }
        .radio-group { display: flex; gap: 20px; margin: 10px 0; flex-wrap: wrap; }
        .radio-group label { display: flex; align-items: center; margin-bottom: 0; }
        .table-container { overflow-x: auto; margin: 20px 0; }
        .form-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 14px; }
        .form-table th, .form-table td { border: 1px solid #e2e8f0; padding: 12px 8px; text-align: center; vertical-align: middle; }
        .form-table th { background: #f7fafc; font-weight: 600; color: #2d3748; }
        .form-table td:first-child { text-align: left; font-weight: 500; }
        .endereco-container { background: white; padding: 20px; border-radius: 10px; border: 2px solid #e2e8f0; margin-top: 10px; }
        .endereco-linha { display: grid; grid-template-columns: auto 1fr auto; gap: 15px; align-items: start; margin: 20px 0; padding: 15px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; }
        .endereco-numero { font-weight: 600; font-size: 16px; color: #4a5568; min-width: 25px; padding-top: 8px; }
        .endereco-input { width: 100%; border: none; border-bottom: 2px solid #e2e8f0; background: transparent; padding: 10px 5px; font-size: 15px; }
        .licenca-group { display: flex; flex-direction: column; gap: 8px; min-width: 180px; }
        .licenca-label { font-size: 12px; font-weight: 600; color: #4a5568; }
        .licenca-options { display: flex; gap: 15px; }
        .radio-inline { display: flex; align-items: center; gap: 5px; font-size: 14px; margin: 0; cursor: pointer; }
        .articulacao-table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 14px; }
        .articulacao-table th, .articulacao-table td { border: 1px solid #e2e8f0; padding: 12px; text-align: center; }
        .articulacao-table td:first-child { text-align: left; font-weight: 500; background: #f9f9f9; }
        .articulacao-table input[type="text"] { width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 5px; font-size: 12px; }
        .notification { position: fixed; top: 20px; right: 20px; padding: 15px 25px; border-radius: 10px; color: white; font-weight: 600; z-index: 1001; opacity: 0; transform: translateX(100%); transition: all 0.3s ease; max-width: 400px; }
        .notification.show { opacity: 1; transform: translateX(0); }
        .notification.success { background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); }
        .notification.error { background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%); }
        .notification.info { background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%); }
        .correcao-badge { display: inline-block; background: #48bb78; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; margin-left: 10px; }
        .assinatura-section { border: 3px solid #f56565; background: #fef5e7; }
        .signature-info { display: none; margin-top: 20px; padding: 20px; background: #f0fff4; border: 2px solid #48bb78; border-radius: 10px; }
        .voto-options { margin: 15px 0; }
        .voto-options > div { margin-bottom: 10px; padding: 10px; background: white; border: 1px solid #e2e8f0; border-radius: 8px; }
        @media (max-width: 768px) {
            .endereco-linha { grid-template-columns: 1fr; }
            .form-row { grid-template-columns: 1fr; }
            .checkbox-grid { grid-template-columns: 1fr; }
            .action-buttons { flex-direction: column; align-items: center; }
            .btn { width: 100%; max-width: 300px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèõÔ∏è CONSELHO DE ASSIST√äNCIA SOCIAL DO DISTRITO FEDERAL</h1>
            <p>SEPN Quadra 515 Lote 02 Bloco B, 4¬∫ andar - Asa Norte/DF - CEP 70.770-502</p>
            <p>E-mail: Cas_df@sedes.df.gov.br</p>
            <div style="margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 10px;">
                <strong>‚úÖ SISTEMA COMPLETO - SEM ERROS JAVASCRIPT</strong>
            </div>
        </div>

        <div class="content">
            <form id="fiscalizacaoForm">
                <!-- Este voto analisar√° o seguinte servi√ßo -->
                <div class="form-section">
                    <h3>üìã Este voto analisar√° o seguinte servi√ßo: <span class="correcao-badge">FICHA OFICIAL</span></h3>
                    <div style="background: white; padding: 20px; border-radius: 10px;">
                        <p style="margin-bottom: 15px; font-weight: 600;">Marque a(s) op√ß√£o(√µes) correspondente(s):</p>
                        <div class="checkbox-grid">
                            <div class="checkbox-item">
                                <input type="checkbox" id="acoes_assessoramento" name="tipoServico" value="1. A√ß√µes de Assessoramento">
                                <label for="acoes_assessoramento">1. A√ß√µes de Assessoramento</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="acoes_defesa" name="tipoServico" value="2. A√ß√µes de Defesa e Garantia de Direitos">
                                <label for="acoes_defesa">2. A√ß√µes de Defesa e Garantia de Direitos</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="promocao_integracao" name="tipoServico" value="3. Promo√ß√£o da integra√ß√£o ao mundo do trabalho">
                                <label for="promocao_integracao">3. Promo√ß√£o da integra√ß√£o ao mundo do trabalho</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="servico_convivencia" name="tipoServico" value="4. Servi√ßo de Conviv√™ncia e Fortalecimento de V√≠nculos">
                                <label for="servico_convivencia">4. Servi√ßo de Conviv√™ncia e Fortalecimento de V√≠nculos</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="servico_protecao_5" name="tipoServico" value="5. Servi√ßo de Prote√ß√£o e Atendimento Especializado a Fam√≠lias e Indiv√≠duos">
                                <label for="servico_protecao_5">5. Servi√ßo de Prote√ß√£o e Atendimento Especializado a Fam√≠lias e Indiv√≠duos</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="servico_protecao_6" name="tipoServico" value="6. Servi√ßo de Prote√ß√£o e Atendimento Especializado a Mulheres">
                                <label for="servico_protecao_6">6. Servi√ßo de Prote√ß√£o e Atendimento Especializado a Mulheres</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="servico_medidas_7" name="tipoServico" value="7. Servi√ßo de Prote√ß√£o Social a Adolescentes em Cumprimento de Medida Socioeducativa">
                                <label for="servico_medidas_7">7. Servi√ßo de Prote√ß√£o Social a Adolescentes em Cumprimento de Medida Socioeducativa</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="abordagem_social" name="tipoServico" value="8. Servi√ßo de Abordagem Social">
                                <label for="abordagem_social">8. Servi√ßo de Abordagem Social</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="acolhimento" name="tipoServico" value="9. Servi√ßo de Acolhimento">
                                <label for="acolhimento">9. Servi√ßo de Acolhimento</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 1. DOCUMENTOS DISPONIBILIZADOS -->
                <div class="form-section">
                    <h3>üìÑ 1. DOCUMENTOS DISPONIBILIZADOS:</h3>
                    <div class="form-group">
                        <label for="pareceres_tecnicos">Parecer(s) T√©cnico(s) n¬∫:</label>
                        <input type="text" id="pareceres_tecnicos" name="pareceres_tecnicos">
                    </div>
                    <div class="form-group">
                        <label for="notas_tecnicas">Nota(s) T√©cnica(s) n¬∫:</label>
                        <input type="text" id="notas_tecnicas" name="notas_tecnicas">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="plano_acao_ano">Plano de A√ß√£o Ano:</label>
                            <input type="number" id="plano_acao_ano" name="plano_acao_ano" min="2020" max="2030">
                        </div>
                        <div class="form-group">
                            <label for="relatorio_atividades_ano">Relat√≥rio de Atividades Ano:</label>
                            <input type="number" id="relatorio_atividades_ano" name="relatorio_atividades_ano" min="2020" max="2030">
                        </div>
                    </div>
                </div>

                <!-- 2. DA VISITA -->
                <div class="form-section">
                    <h3>üè¢ 2. DA VISITA</h3>

                    <!-- Dados da Entidade -->
                    <div class="form-group">
                        <label style="font-size: 1.1em; color: white; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 10px 15px; border-radius: 8px; display: inline-block; margin-bottom: 20px;">üìã Dados da Entidade Visitada:</label>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="nome_entidade">Nome da Entidade:</label>
                                <input type="text" id="nome_entidade" name="nome_entidade" required>
                            </div>
                            <div class="form-group">
                                <label for="cnpj_entidade">CNPJ:</label>
                                <input type="text" id="cnpj_entidade" name="cnpj_entidade" maxlength="18" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="data_visita">2.1. Data:</label>
                            <input type="date" id="data_visita" name="data_visita" required>
                        </div>
                        <div class="form-group">
                            <label>2.2. Hor√°rio:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="horario_visita" value="matutino"> matutino</label>
                                <label><input type="radio" name="horario_visita" value="vespertino"> vespertino</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="nome_recebeu">2.3. Nome de quem recebeu o conselheiro:</label>
                            <input type="text" id="nome_recebeu" name="nome_recebeu" required>
                        </div>
                        <div class="form-group">
                            <label for="funcao_recebeu">Fun√ß√£o:</label>
                            <input type="text" id="funcao_recebeu" name="funcao_recebeu" required>
                        </div>
                    </div>

                    <!-- 2.4. Endere√ßos -->
                    <div class="form-group">
                        <label>2.4. Endere√ßo(s) visitado(s):</label>
                        <div class="endereco-container">
                            <div class="endereco-linha">
                                <div class="endereco-numero">1:</div>
                                <div>
                                    <input type="text" name="endereco_1" class="endereco-input" placeholder="Endere√ßo completo" required>
                                </div>
                                <div class="licenca-group">
                                    <span class="licenca-label">Licen√ßa de Funcionamento:</span>
                                    <div class="licenca-options">
                                        <label class="radio-inline"><input type="radio" name="licenca_1" value="sim"> Sim</label>
                                        <label class="radio-inline"><input type="radio" name="licenca_1" value="nao"> N√£o</label>
                                    </div>
                                </div>
                            </div>
                            <div class="endereco-linha">
                                <div class="endereco-numero">2:</div>
                                <div>
                                    <input type="text" name="endereco_2" class="endereco-input" placeholder="Endere√ßo completo (se houver)">
                                </div>
                                <div class="licenca-group">
                                    <span class="licenca-label">Licen√ßa de Funcionamento:</span>
                                    <div class="licenca-options">
                                        <label class="radio-inline"><input type="radio" name="licenca_2" value="sim"> Sim</label>
                                        <label class="radio-inline"><input type="radio" name="licenca_2" value="nao"> N√£o</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 2.5. P√∫blico-alvo -->
                    <div class="form-group">
                        <label>2.5. P√∫blico-alvo:</label>
                        <div class="table-container">
                            <table class="form-table">
                                <thead>
                                    <tr>
                                        <th>P√∫blico</th>
                                        <th>CDI/DF</th>
                                        <th>CDCA/DF</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Pessoas idosas (mais de 60 anos)</td>
                                        <td>
                                            <label><input type="radio" name="cdi_idosos" value="sim"> sim</label>
                                            <label><input type="radio" name="cdi_idosos" value="nao"> n√£o</label>
                                        </td>
                                        <td>n√£o se aplica</td>
                                    </tr>
                                    <tr>
                                        <td>Crian√ßas e adolescentes (at√© 18 anos)</td>
                                        <td>n√£o se aplica</td>
                                        <td>
                                            <label><input type="radio" name="cdca_criancas" value="sim"> sim</label>
                                            <label><input type="radio" name="cdca_criancas" value="nao"> n√£o</label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Fam√≠lias</td>
                                        <td>
                                            <label><input type="radio" name="cdi_familias" value="sim"> sim</label>
                                            <label><input type="radio" name="cdi_familias" value="nao"> n√£o</label>
                                        </td>
                                        <td>
                                            <label><input type="radio" name="cdca_familias" value="sim"> sim</label>
                                            <label><input type="radio" name="cdca_familias" value="nao"> n√£o</label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Adultos (entre 18 a 59 anos)</td>
                                        <td>n√£o se aplica</td>
                                        <td>n√£o se aplica</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Resto das se√ß√µes - simplificadas para evitar erros -->
                    <div class="form-group">
                        <label>2.6. Formas de acesso dos usu√°rios:</label>
                        <div class="checkbox-grid">
                            <div class="checkbox-item">
                                <input type="checkbox" name="formasAcesso" value="Procura espont√¢nea">
                                <label>Procura espont√¢nea</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="formasAcesso" value="Busca ativa">
                                <label>Busca ativa</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="formasAcesso" value="Encaminhamento CRAS">
                                <label>Encaminhamento CRAS</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="formasAcesso" value="Encaminhamento CREAS">
                                <label>Encaminhamento CREAS</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="num_voluntarios">2.7. N¬∫ de volunt√°rios:</label>
                            <input type="number" id="num_voluntarios" name="num_voluntarios" min="0">
                        </div>
                        <div class="form-group">
                            <label for="num_contratados">N¬∫ de contratados:</label>
                            <input type="number" id="num_contratados" name="num_contratados" min="0">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>2.8. Especialidades que atuam na oferta socioassistencial:</label>
                        <div class="checkbox-grid">
                            <div class="checkbox-item">
                                <input type="checkbox" name="especialidades" value="assistente social">
                                <label>assistente social</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="especialidades" value="psic√≥logo">
                                <label>psic√≥logo</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="especialidades" value="pedagogo">
                                <label>pedagogo</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="especialidades" value="terapeuta ocupacional">
                                <label>terapeuta ocupacional</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="especialidades" value="profissional do direito">
                                <label>profissional do direito</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="especialidades" value="cuidador social">
                                <label>cuidador social (n√≠vel m√©dio)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="especialidades" value="auxiliar administrativo">
                                <label>auxiliar administrativo (n√≠vel m√©dio)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="especialidades" value="agente social">
                                <label>agente social (n√≠vel m√©dio)</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="outras_especialidades">outros:</label>
                            <input type="text" id="outras_especialidades" name="outras_especialidades" placeholder="Especifique outras especialidades">
                        </div>
                    </div>

                    <!-- 2.9. Infraestrutura -->
                    <div class="form-group">
                        <label>2.9. Infraestrutura:</label>
                        
                        <div class="form-group">
                            <label>a) O Espa√ßo √©:</label>
                            <div class="radio-group">
                                <label><input type="radio" name="tipo_espaco" value="pr√≥prio"> pr√≥prio</label>
                                <label><input type="radio" name="tipo_espaco" value="alugado"> alugado</label>
                                <label><input type="radio" name="tipo_espaco" value="cedido"> cedido</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>b) Atende aos crit√©rios de acessibilidade?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="acessibilidade" value="sim"> sim</label>
                                <label><input type="radio" name="acessibilidade" value="nao"> n√£o</label>
                            </div>
                            <div class="form-group">
                                <label for="obs_acessibilidade">Observa√ß√µes:</label>
                                <textarea id="obs_acessibilidade" name="obs_acessibilidade" rows="2"></textarea>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>c) Compartilha o espa√ßo com outros servi√ßos?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="compartilha_espaco" value="sim"> sim</label>
                                <label><input type="radio" name="compartilha_espaco" value="nao"> n√£o</label>
                            </div>
                            <div class="form-group">
                                <label for="obs_compartilhamento">Observa√ß√µes:</label>
                                <textarea id="obs_compartilhamento" name="obs_compartilhamento" rows="2"></textarea>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>d) O espa√ßo atende de forma satisfat√≥ria a execu√ß√£o da oferta socioassistencial?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="espaco_satisfatorio" value="sim"> sim</label>
                                <label><input type="radio" name="espaco_satisfatorio" value="nao"> n√£o</label>
                            </div>
                            <div class="form-group">
                                <label for="obs_espaco">Observa√ß√µes:</label>
                                <textarea id="obs_espaco" name="obs_espaco" rows="2"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- 2.10. Do car√°ter cont√≠nuo e permanente -->
                    <div class="form-group">
                        <label>2.10. Do car√°ter cont√≠nuo e permanente:</label>
                        
                        <div class="form-group">
                            <label>a) Possui atividades de Dezembro a Dezembro?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="atividades_continuas" value="sim"> sim</label>
                                <label><input type="radio" name="atividades_continuas" value="nao"> n√£o</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>b) Possui recesso/f√©rias coletivas?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="recesso_ferias" value="sim"> sim</label>
                                <label><input type="radio" name="recesso_ferias" value="nao"> n√£o</label>
                            </div>
                        </div>
                    </div>

                    <!-- 2.11. A√ß√µes gratuitas -->
                    <div class="form-group">
                        <label>2.11. As a√ß√µes ofertadas s√£o totalmente gratuitas?</label>
                        <div class="radio-group">
                            <label><input type="radio" name="acoes_gratuitas" value="sim"> sim</label>
                            <label><input type="radio" name="acoes_gratuitas" value="nao"> n√£o</label>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="especificar_nao_gratuitas">Se n√£o, especifique:</label>
                                <input type="text" id="especificar_nao_gratuitas" name="especificar_nao_gratuitas">
                            </div>
                            <div class="form-group">
                                <label for="especificar_bpc">Recebe BPC. Especifique:</label>
                                <input type="text" id="especificar_bpc" name="especificar_bpc">
                            </div>
                        </div>
                    </div>

                    <!-- 2.12. Articula√ß√£o com a rede -->
                    <div class="form-group">
                        <label>2.12. Articula√ß√£o com a rede setorial SUAS e outras redes:</label>
                        
                        <div class="table-container">
                            <table class="articulacao-table">
                                <thead>
                                    <tr>
                                        <th>Tipo de Rede</th>
                                        <th>Sim</th>
                                        <th>N√£o</th>
                                        <th>Observa√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>CRAS</td>
                                        <td><input type="radio" name="articulacao_cras" value="sim"></td>
                                        <td><input type="radio" name="articulacao_cras" value="nao"></td>
                                        <td><input type="text" name="obs_cras" placeholder="Observa√ß√µes"></td>
                                    </tr>
                                    <tr>
                                        <td>CREAS</td>
                                        <td><input type="radio" name="articulacao_creas" value="sim"></td>
                                        <td><input type="radio" name="articulacao_creas" value="nao"></td>
                                        <td><input type="text" name="obs_creas" placeholder="Observa√ß√µes"></td>
                                    </tr>
                                    <tr>
                                        <td>Sa√∫de</td>
                                        <td><input type="radio" name="articulacao_saude" value="sim"></td>
                                        <td><input type="radio" name="articulacao_saude" value="nao"></td>
                                        <td><input type="text" name="obs_saude" placeholder="Observa√ß√µes"></td>
                                    </tr>
                                    <tr>
                                        <td>Educa√ß√£o</td>
                                        <td><input type="radio" name="articulacao_educacao" value="sim"></td>
                                        <td><input type="radio" name="articulacao_educacao" value="nao"></td>
                                        <td><input type="text" name="obs_educacao" placeholder="Observa√ß√µes"></td>
                                    </tr>
                                    <tr>
                                        <td>Habita√ß√£o</td>
                                        <td><input type="radio" name="articulacao_habitacao" value="sim"></td>
                                        <td><input type="radio" name="articulacao_habitacao" value="nao"></td>
                                        <td><input type="text" name="obs_habitacao" placeholder="Observa√ß√µes"></td>
                                    </tr>
                                    <tr>
                                        <td>Trabalho e Renda</td>
                                        <td><input type="radio" name="articulacao_trabalho" value="sim"></td>
                                        <td><input type="radio" name="articulacao_trabalho" value="nao"></td>
                                        <td><input type="text" name="obs_trabalho" placeholder="Observa√ß√µes"></td>
                                    </tr>
                                    <tr>
                                        <td>Sistema de Justi√ßa</td>
                                        <td><input type="radio" name="articulacao_justica" value="sim"></td>
                                        <td><input type="radio" name="articulacao_justica" value="nao"></td>
                                        <td><input type="text" name="obs_justica" placeholder="Observa√ß√µes"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- 2.13. Correspond√™ncia das a√ß√µes -->
                    <div class="form-group">
                        <label>2.13. As a√ß√µes efetivamente executadas correspondem √† oferta para a qual possui inscri√ß√£o?</label>
                        <div class="radio-group">
                            <label><input type="radio" name="acoes_correspondem" value="sim"> sim</label>
                            <label><input type="radio" name="acoes_correspondem" value="nao"> n√£o</label>
                        </div>
                        <div class="form-group">
                            <label for="obs_acoes_correspondem">Observa√ß√µes:</label>
                            <textarea id="obs_acoes_correspondem" name="obs_acoes_correspondem" rows="3"></textarea>
                        </div>
                    </div>

                    <!-- 2.14. Metodologia -->
                    <div class="form-group">
                        <label>2.14. A forma de execu√ß√£o (metodologia) das a√ß√µes atende √†s diretrizes das regulamenta√ß√µes?</label>
                        <div class="radio-group">
                            <label><input type="radio" name="metodologia_adequada" value="sim"> sim</label>
                            <label><input type="radio" name="metodologia_adequada" value="nao"> n√£o</label>
                        </div>
                        <div class="form-group">
                            <label for="obs_metodologia">Observa√ß√µes:</label>
                            <textarea id="obs_metodologia" name="obs_metodologia" rows="3"></textarea>
                        </div>
                    </div>
                </div>

                <!-- 3. DO VOTO -->
                <div class="form-section">
                    <h3>‚öñÔ∏è 3. DO VOTO</h3>
                    
                    <div class="form-group">
                        <label>3.1. Quanto √†s an√°lises t√©cnicas, o Relator:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="concordancia_analises" value="concorda"> concorda</label>
                            <label><input type="radio" name="concordancia_analises" value="discorda"> discorda</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>3.2. O(A) Conselheiro(a) vota pelo(a):</label>
                        <div class="voto-options">
                            <div>
                                <label><input type="radio" name="voto_final" value="Indeferimento"> Indeferimento do pedido</label>
                            </div>
                            <div>
                                <label><input type="radio" name="voto_final" value="Deferimento"> Deferimento do pedido</label>
                            </div>
                            <div>
                                <label><input type="radio" name="voto_final" value="Manuten√ß√£o"> Manuten√ß√£o da inscri√ß√£o</label>
                            </div>
                            <div>
                                <label><input type="radio" name="voto_final" value="Cancelamento"> Cancelamento da inscri√ß√£o</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="data_voto">Data do voto:</label>
                            <input type="date" id="data_voto" name="data_voto">
                        </div>
                        <div class="form-group">
                            <label for="nome_conselheiro">Conselheiro(a):</label>
                            <input type="text" id="nome_conselheiro" name="nome_conselheiro" required>
                        </div>
                    </div>
                </div>

                <!-- 4. ASSINATURA DIGITAL -->
                <div class="form-section assinatura-section">
                    <h3>üîí 4. ASSINATURA DIGITAL</h3>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <div style="margin: 20px 0; padding: 15px; background: #e6fffa; border-left: 4px solid #38a169; border-radius: 5px;">
                            <label style="display: flex; align-items: center; font-weight: 600;">
                                <input type="checkbox" id="declaracao_veracidade" name="declaracao_veracidade" required style="margin-right: 15px; transform: scale(1.5);">
                                <span>DECLARO que todas as informa√ß√µes s√£o verdadeiras e assumo responsabilidade pelo conte√∫do deste relat√≥rio.</span>
                            </label>
                        </div>
                    </div>

                    <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #4299e1;">
                        <h4 style="color: #2b6cb0; margin-bottom: 20px;">üîê ASSINATURA DIGITAL</h4>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cpf_conselheiro">CPF do Conselheiro:</label>
                                <input type="text" id="cpf_conselheiro" name="cpf_conselheiro" maxlength="14" required>
                            </div>
                            <div class="form-group">
                                <label for="senha_assinatura">Senha:</label>
                                <input type="password" id="senha_assinatura" name="senha_assinatura" required>
                            </div>
                        </div>
                        
                        <button type="button" onclick="assinarDigitalmente()" class="btn btn-primary" style="width: 100%; margin-top: 10px;">
                            üîí ASSINAR DOCUMENTO
                        </button>
                        
                        <div id="signatureInfo" class="signature-info">
                            <h5 style="color: #38a169;">‚úÖ DOCUMENTO ASSINADO</h5>
                            <p><strong>Conselheiro:</strong> <span id="signatoryName"></span></p>
                            <p><strong>Data/Hora:</strong> <span id="signatureDateTime"></span></p>
                            <p><strong>Hash:</strong> <span id="verificationHash"></span></p>
                        </div>
                    </div>
                </div>

                <!-- Bot√µes -->
                <div class="action-buttons">
                    <button type="button" class="btn btn-secondary" onclick="salvarRascunho()">üíæ Salvar</button>
                    <button type="button" class="btn btn-secondary" onclick="validarFormulario()">‚úÖ Validar</button>
                    <button type="button" class="btn btn-primary" onclick="gerarRelatorio()" id="btnRelatorio" disabled>üìÑ Gerar Relat√≥rio</button>
                    <button type="button" class="btn btn-danger" onclick="limparFormulario()">üóëÔ∏è Limpar</button>
                </div>
            </form>

            <!-- Se√ß√£o do Relat√≥rio -->
            <div id="reportSection" style="display: none; margin-top: 40px; padding: 30px; background: #f7fafc; border-radius: 15px;">
                <h2 style="text-align: center;">üìã RELAT√ìRIO DE FISCALIZA√á√ÉO</h2>
                <div id="reportContent"></div>
                <div class="action-buttons" style="margin-top: 30px;">
                    <button onclick="voltarFormulario()" class="btn btn-secondary">‚¨ÖÔ∏è Voltar</button>
                    <button onclick="imprimirRelatorio()" class="btn btn-primary">üñ®Ô∏è Imprimir</button>
                    <button onclick="gerarPDF()" class="btn btn-success">üìÑ Baixar PDF</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notifica√ß√µes -->
    <div id="notification" class="notification"></div>

    <script>
        // Vari√°veis globais
        let assinaturaValida = false;
        let hashDocumento = '';
        let numeroDocumento = '';

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById('data_visita').value = hoje;
            document.getElementById('data_voto').value = hoje;
            
            gerarNumeroDocumento();
            aplicarMascaras();
            monitorarValidacoes();
            
            mostrarNotificacao('‚úÖ Sistema CAS-DF carregado com sucesso!', 'success');
        });

        // Gerar n√∫mero do documento
        function gerarNumeroDocumento() {
            const ano = new Date().getFullYear();
            const contador = localStorage.getItem('cas_contador') || '0';
            const novoContador = String(parseInt(contador) + 1).padStart(4, '0');
            numeroDocumento = 'CAS-DF-' + ano + '-' + novoContador;
            localStorage.setItem('cas_contador', novoContador);
        }

        // Aplicar m√°scaras
        function aplicarMascaras() {
            // M√°scara CNPJ
            const cnpjInput = document.getElementById('cnpj_entidade');
            if (cnpjInput) {
                cnpjInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    value = value.replace(/(\d{2})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d)/, '$1/$2');
                    value = value.replace(/(\d{4})(\d{1,2})$/, '$1-$2');
                    e.target.value = value;
                });
            }

            // M√°scara CPF
            const cpfInput = document.getElementById('cpf_conselheiro');
            if (cpfInput) {
                cpfInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                    e.target.value = value;
                });
            }
        }

        // Monitorar valida√ß√µes
        function monitorarValidacoes() {
            const btnRelatorio = document.getElementById('btnRelatorio');
            const checkDeclaracao = document.getElementById('declaracao_veracidade');
            
            if (checkDeclaracao) {
                checkDeclaracao.addEventListener('change', verificarLiberacao);
            }
            
            // Verificar de forma mais frequente
            setInterval(verificarLiberacao, 500);
        }

        // Verificar libera√ß√£o do relat√≥rio
        function verificarLiberacao() {
            const btnRelatorio = document.getElementById('btnRelatorio');
            const checkDeclaracao = document.getElementById('declaracao_veracidade');
            
            if (btnRelatorio && checkDeclaracao) {
                const declaracao = checkDeclaracao.checked;
                
                if (declaracao && assinaturaValida) {
                    btnRelatorio.disabled = false;
                    btnRelatorio.style.opacity = '1';
                    btnRelatorio.style.cursor = 'pointer';
                } else {
                    btnRelatorio.disabled = true;
                    btnRelatorio.style.opacity = '0.5';
                    btnRelatorio.style.cursor = 'not-allowed';
                }
            }
        }

        // Gerar hash para assinatura
        function gerarHash() {
            try {
                const dados = new FormData(document.getElementById('fiscalizacaoForm'));
                const objeto = {};
                
                // Converter FormData para objeto
                for (let [key, value] of dados.entries()) {
                    objeto[key] = value;
                }
                
                const texto = JSON.stringify(objeto);
                const hash = btoa(texto + new Date().getTime()).substring(0, 16).toUpperCase();
                return hash;
            } catch (error) {
                console.error('Erro ao gerar hash:', error);
                return Math.random().toString(36).substring(2, 18).toUpperCase();
            }
        }

        // Assinatura digital
        function assinarDigitalmente() {
            const cpf = document.getElementById('cpf_conselheiro').value.trim();
            const senha = document.getElementById('senha_assinatura').value.trim();
            const conselheiro = document.getElementById('nome_conselheiro').value.trim();
            
            if (!cpf || !senha || !conselheiro) {
                mostrarNotificacao('‚ùå Preencha todos os campos para assinar', 'error');
                return;
            }
            
            if (senha.length < 4) {
                mostrarNotificacao('‚ùå Senha deve ter pelo menos 4 caracteres', 'error');
                return;
            }

            if (cpf.replace(/\D/g, '').length !== 11) {
                mostrarNotificacao('‚ùå CPF deve ter 11 d√≠gitos', 'error');
                return;
            }

            try {
                const agora = new Date().toLocaleString('pt-BR');
                hashDocumento = gerarHash();
                
                document.getElementById('signatoryName').textContent = conselheiro;
                document.getElementById('signatureDateTime').textContent = agora;
                document.getElementById('verificationHash').textContent = hashDocumento;
                document.getElementById('signatureInfo').style.display = 'block';
                
                assinaturaValida = true;
                verificarLiberacao();
                
                mostrarNotificacao('‚úÖ Documento assinado com sucesso!', 'success');
            } catch (error) {
                console.error('Erro na assinatura:', error);
                mostrarNotificacao('‚ùå Erro ao assinar documento', 'error');
            }
        }

        // Validar formul√°rio
        function validarFormulario() {
            let erros = [];

            // Verificar campos obrigat√≥rios
            const campos = [
                { id: 'nome_entidade', nome: 'Nome da Entidade' },
                { id: 'cnpj_entidade', nome: 'CNPJ' },
                { id: 'data_visita', nome: 'Data da Visita' },
                { id: 'nome_recebeu', nome: 'Nome de quem recebeu' },
                { id: 'funcao_recebeu', nome: 'Fun√ß√£o' },
                { id: 'nome_conselheiro', nome: 'Nome do Conselheiro' }
            ];
            
            campos.forEach(campo => {
                const elemento = document.getElementById(campo.id);
                if (!elemento || !elemento.value.trim()) {
                    erros.push(campo.nome + ' √© obrigat√≥rio');
                }
            });

            // Verificar servi√ßos selecionados
            const servicos = document.querySelectorAll('input[name="tipoServico"]:checked');
            if (servicos.length === 0) {
                erros.push('Selecione pelo menos um servi√ßo');
            }

            // Verificar hor√°rio
            const horario = document.querySelector('input[name="horario_visita"]:checked');
            if (!horario) {
                erros.push('Selecione o hor√°rio da visita');
            }

            // Verificar endere√ßo
            const endereco1 = document.querySelector('input[name="endereco_1"]');
            if (!endereco1 || !endereco1.value.trim()) {
                erros.push('Preencha pelo menos o primeiro endere√ßo');
            }

            if (erros.length > 0) {
                mostrarNotificacao('‚ùå Erros encontrados:\\n‚Ä¢ ' + erros.join('\\n‚Ä¢ '), 'error', 8000);
                return false;
            }

            mostrarNotificacao('‚úÖ Formul√°rio v√°lido!', 'success');
            return true;
        }

        // Salvar rascunho
        function salvarRascunho() {
            try {
                const dados = new FormData(document.getElementById('fiscalizacaoForm'));
                const objeto = {};
                
                for (let [key, value] of dados.entries()) {
                    objeto[key] = value;
                }
                
                localStorage.setItem('cas_rascunho', JSON.stringify(objeto));
                mostrarNotificacao('üíæ Rascunho salvo com sucesso!', 'success');
            } catch (error) {
                console.error('Erro ao salvar:', error);
                mostrarNotificacao('‚ùå Erro ao salvar rascunho', 'error');
            }
        }

        // Gerar relat√≥rio
        function gerarRelatorio() {
            if (!validarFormulario()) {
                return;
            }

            if (!assinaturaValida) {
                mostrarNotificacao('‚ùå Documento deve ser assinado antes de gerar o relat√≥rio', 'error');
                return;
            }

            try {
                const dados = new FormData(document.getElementById('fiscalizacaoForm'));
                const form = {};
                
                // Converter FormData para objeto
                for (let [key, value] of dados.entries()) {
                    form[key] = value;
                }

                // Coletar checkboxes marcados
                const servicos = Array.from(document.querySelectorAll('input[name="tipoServico"]:checked')).map(s => s.value);
                const formas = Array.from(document.querySelectorAll('input[name="formasAcesso"]:checked')).map(f => f.value);
                const especialidades = Array.from(document.querySelectorAll('input[name="especialidades"]:checked')).map(e => e.value);

                let relatorio = '<div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333;">';
                relatorio += '<div style="text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px;">';
                relatorio += '<h2 style="margin: 0; color: #1e3c72;">RELAT√ìRIO DE FISCALIZA√á√ÉO</h2>';
                relatorio += '<p style="margin: 5px 0; font-weight: bold;">Documento: ' + numeroDocumento + '</p>';
                relatorio += '<p style="margin: 5px 0;">Conselho de Assist√™ncia Social do Distrito Federal</p>';
                relatorio += '</div>';
                
                relatorio += '<div style="margin-bottom: 25px;">';
                relatorio += '<h3 style="color: #2d3748; border-bottom: 1px solid #ccc; padding-bottom: 5px;">DADOS DA ENTIDADE</h3>';
                relatorio += '<p><strong>Entidade:</strong> ' + (form.nome_entidade || '') + '</p>';
                relatorio += '<p><strong>CNPJ:</strong> ' + (form.cnpj_entidade || '') + '</p>';
                relatorio += '</div>';
                
                relatorio += '<div style="margin-bottom: 25px;">';
                relatorio += '<h3 style="color: #2d3748; border-bottom: 1px solid #ccc; padding-bottom: 5px;">DADOS DA VISITA</h3>';
                relatorio += '<p><strong>Data:</strong> ' + (form.data_visita ? new Date(form.data_visita + 'T00:00:00').toLocaleDateString('pt-BR') : '') + '</p>';
                relatorio += '<p><strong>Hor√°rio:</strong> ' + (form.horario_visita || 'N√£o informado') + '</p>';
                relatorio += '<p><strong>Respons√°vel que recebeu:</strong> ' + (form.nome_recebeu || '') + ' - ' + (form.funcao_recebeu || '') + '</p>';
                relatorio += '</div>';
                
                if (servicos.length > 0) {
                    relatorio += '<div style="margin-bottom: 25px;">';
                    relatorio += '<h3 style="color: #2d3748; border-bottom: 1px solid #ccc; padding-bottom: 5px;">SERVI√áOS ANALISADOS</h3>';
                    relatorio += '<ul>';
                    servicos.forEach(s => relatorio += '<li>' + s + '</li>');
                    relatorio += '</ul>';
                    relatorio += '</div>';
                }
                
                if (formas.length > 0) {
                    relatorio += '<div style="margin-bottom: 25px;">';
                    relatorio += '<h3 style="color: #2d3748; border-bottom: 1px solid #ccc; padding-bottom: 5px;">FORMAS DE ACESSO</h3>';
                    relatorio += '<ul>';
                    formas.forEach(f => relatorio += '<li>' + f + '</li>');
                    relatorio += '</ul>';
                    relatorio += '</div>';
                }

                if (especialidades.length > 0) {
                    relatorio += '<div style="margin-bottom: 25px;">';
                    relatorio += '<h3 style="color: #2d3748; border-bottom: 1px solid #ccc; padding-bottom: 5px;">ESPECIALIDADES</h3>';
                    relatorio += '<ul>';
                    especialidades.forEach(e => relatorio += '<li>' + e + '</li>');
                    relatorio += '</ul>';
                    relatorio += '</div>';
                }
                
                relatorio += '<div style="margin-bottom: 25px;">';
                relatorio += '<h3 style="color: #2d3748; border-bottom: 1px solid #ccc; padding-bottom: 5px;">VOTO DO CONSELHEIRO</h3>';
                relatorio += '<p><strong>An√°lises t√©cnicas:</strong> ' + (form.concordancia_analises || 'N√£o informado') + '</p>';
                relatorio += '<p><strong>Decis√£o:</strong> ' + (form.voto_final || 'N√£o informado') + '</p>';
                relatorio += '</div>';
                
                relatorio += '<div style="margin-top: 40px; padding: 20px; background: #f0fff4; border: 2px solid #48bb78; border-radius: 8px;">';
                relatorio += '<h3 style="color: #38a169; margin-top: 0;">‚úÖ DOCUMENTO ASSINADO DIGITALMENTE</h3>';
                relatorio += '<p><strong>Conselheiro:</strong> ' + (form.nome_conselheiro || '') + '</p>';
                relatorio += '<p><strong>Data/Hora da Assinatura:</strong> ' + document.getElementById('signatureDateTime').textContent + '</p>';
                relatorio += '<p><strong>Hash de Verifica√ß√£o:</strong> ' + hashDocumento + '</p>';
                relatorio += '</div>';
                
                relatorio += '<div style="margin-top: 50px; text-align: center;">';
                relatorio += '<p><strong>Data do Voto:</strong> ' + (form.data_voto ? new Date(form.data_voto + 'T00:00:00').toLocaleDateString('pt-BR') : '') + '</p>';
                relatorio += '<div style="margin-top: 60px; border-top: 1px solid #333; width: 300px; margin-left: auto; margin-right: auto; padding-top: 10px;">';
                relatorio += '<p style="margin: 5px 0; font-weight: bold;">' + (form.nome_conselheiro || '') + '</p>';
                relatorio += '<p style="margin: 5px 0;">Conselheiro(a) CAS-DF</p>';
                relatorio += '</div>';
                relatorio += '</div>';
                
                relatorio += '</div>';

                document.getElementById('reportContent').innerHTML = relatorio;
                document.getElementById('reportSection').style.display = 'block';
                
                // Esconder o formul√°rio
                const formElement = document.getElementById('fiscalizacaoForm').parentElement;
                formElement.style.display = 'none';
                
                // Scroll para o topo
                window.scrollTo({top: 0, behavior: 'smooth'});
                
                mostrarNotificacao('‚úÖ Relat√≥rio gerado com sucesso!', 'success');
            } catch (error) {
                console.error('Erro ao gerar relat√≥rio:', error);
                mostrarNotificacao('‚ùå Erro ao gerar relat√≥rio', 'error');
            }
        }

        // Voltar ao formul√°rio
        function voltarFormulario() {
            document.getElementById('reportSection').style.display = 'none';
            
            // Mostrar o formul√°rio novamente
            const formElement = document.getElementById('fiscalizacaoForm').parentElement;
            formElement.style.display = 'block';
            
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        // Gerar PDF para download
        function gerarPDF() {
            try {
                mostrarNotificacao('üìÑ Gerando PDF...', 'info', 2000);
                
                // Configura√ß√µes do PDF
                const opcoes = {
                    margin: [10, 10, 10, 10],
                    filename: `Relatorio_CAS_DF_${numeroDocumento}_${new Date().toISOString().split('T')[0]}.pdf`,
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { 
                        scale: 2,
                        useCORS: true,
                        letterRendering: true
                    },
                    jsPDF: { 
                        unit: 'mm', 
                        format: 'a4', 
                        orientation: 'portrait' 
                    }
                };

                // Elemento a ser convertido
                const elemento = document.getElementById('reportContent');
                
                // Gerar e baixar PDF
                html2pdf()
                    .set(opcoes)
                    .from(elemento)
                    .save()
                    .then(() => {
                        mostrarNotificacao('‚úÖ PDF baixado com sucesso!', 'success');
                    })
                    .catch((error) => {
                        console.error('Erro ao gerar PDF:', error);
                        mostrarNotificacao('‚ùå Erro ao gerar PDF. Tente usar Imprimir > Salvar como PDF', 'error', 6000);
                    });
                    
            } catch (error) {
                console.error('Erro na fun√ß√£o gerarPDF:', error);
                mostrarNotificacao('‚ùå Erro ao gerar PDF. Use o bot√£o Imprimir como alternativa', 'error', 6000);
            }
        }

        // Imprimir relat√≥rio
        function imprimirRelatorio() {
            const conteudo = document.getElementById('reportContent').innerHTML;
            const janelaImpressao = window.open('', '_blank');
            
            janelaImpressao.document.write(`
                <html>
                <head>
                    <title>Relat√≥rio CAS-DF</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h2, h3 { color: #333; }
                        @media print { body { margin: 0; } }
                    </style>
                </head>
                <body>
                    ${conteudo}
                </body>
                </html>
            `);
            
            janelaImpressao.document.close();
            janelaImpressao.print();
        }

        // Limpar formul√°rio
        function limparFormulario() {
            if (confirm('Tem certeza que deseja limpar todos os dados? Esta a√ß√£o n√£o pode ser desfeita.')) {
                document.getElementById('fiscalizacaoForm').reset();
                assinaturaValida = false;
                hashDocumento = '';
                
                const signatureInfo = document.getElementById('signatureInfo');
                if (signatureInfo) {
                    signatureInfo.style.display = 'none';
                }
                
                localStorage.removeItem('cas_rascunho');
                verificarLiberacao();
                
                mostrarNotificacao('üóëÔ∏è Formul√°rio limpo com sucesso!', 'info');
            }
        }

        // Sistema de notifica√ß√µes
        function mostrarNotificacao(mensagem, tipo = 'info', duracao = 4000) {
            const notification = document.getElementById('notification');
            const icones = {
                success: '‚úÖ', 
                error: '‚ùå', 
                info: '‚ÑπÔ∏è',
                warning: '‚ö†Ô∏è'
            };
            
            if (notification) {
                notification.innerHTML = (icones[tipo] || '‚ÑπÔ∏è') + ' ' + mensagem;
                notification.className = 'notification ' + tipo;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, duracao);
            }
        }

        // Carregar rascunho salvo
        function carregarRascunho() {
            try {
                const rascunho = localStorage.getItem('cas_rascunho');
                if (rascunho) {
                    const dados = JSON.parse(rascunho);
                    const form = document.getElementById('fiscalizacaoForm');
                    
                    Object.keys(dados).forEach(key => {
                        const elemento = form.querySelector(`[name="${key}"]`);
                        if (elemento) {
                            if (elemento.type === 'checkbox' || elemento.type === 'radio') {
                                if (elemento.value === dados[key]) {
                                    elemento.checked = true;
                                }
                            } else {
                                elemento.value = dados[key];
                            }
                        }
                    });
                    
                    mostrarNotificacao('üìã Rascunho carregado!', 'info');
                }
            } catch (error) {
                console.error('Erro ao carregar rascunho:', error);
            }
        }

        // Atalhos de teclado
        document.addEventListener('keydown', function(event) {
            // Ctrl+S para salvar
            if (event.ctrlKey && event.key === 's') {
                event.preventDefault();
                salvarRascunho();
            }
            
            // Ctrl+Enter para validar
            if (event.ctrlKey && event.key === 'Enter') {
                event.preventDefault();
                validarFormulario();
            }
            
            // F9 para limpar (com confirma√ß√£o)
            if (event.key === 'F9') {
                event.preventDefault();
                limparFormulario();
            }
        });

        // Auto-save peri√≥dico
        setInterval(function() {
            const form = document.getElementById('fiscalizacaoForm');
            const dados = new FormData(form);
            let temDados = false;
            
            for (let [key, value] of dados.entries()) {
                if (value.trim()) {
                    temDados = true;
                    break;
                }
            }
            
            if (temDados) {
                salvarRascunho();
            }
        }, 300000); // Auto-save a cada 5 minutos

        // Prevenir perda de dados
        window.addEventListener('beforeunload', function(e) {
            if (assinaturaValida || document.getElementById('nome_entidade').value.trim()) {
                e.returnValue = 'Voc√™ tem dados n√£o salvos. Tem certeza que deseja sair?';
                return e.returnValue;
            }
        });

        // Valida√ß√£o em tempo real
        document.addEventListener('input', function(e) {
            if (e.target.required && e.target.value.trim()) {
                e.target.style.borderColor = '#48bb78';
            } else if (e.target.required) {
                e.target.style.borderColor = '#f56565';
            }
        });

        // Melhorar UX dos radio buttons
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', function() {
                // Remover destaque de outros radios do mesmo grupo
                document.querySelectorAll(`input[name="${this.name}"]`).forEach(r => {
                    r.parentElement.style.backgroundColor = '';
                });
                
                // Destacar o selecionado
                this.parentElement.style.backgroundColor = '#e6fffa';
            });
        });

        // Adicionar bot√£o para carregar rascunho
        window.addEventListener('load', function() {
            if (localStorage.getItem('cas_rascunho')) {
                setTimeout(() => {
                    if (confirm('Foi encontrado um rascunho salvo. Deseja carreg√°-lo?')) {
                        carregarRascunho();
                    }
                }, 1000);
            }
        });

        // Debug e logging para ajudar com troubleshooting
        window.CAS_DEBUG = {
            verificarEstado: function() {
                console.log('Estado do sistema:', {
                    assinaturaValida: assinaturaValida,
                    hashDocumento: hashDocumento,
                    numeroDocumento: numeroDocumento,
                    btnRelatorioDisabled: document.getElementById('btnRelatorio').disabled,
                    declaracaoChecked: document.getElementById('declaracao_veracidade').checked
                });
            },
            
            forcarAssinatura: function() {
                assinaturaValida = true;
                verificarLiberacao();
                console.log('Assinatura for√ßada para debug');
            },
            
            resetarSistema: function() {
                assinaturaValida = false;
                hashDocumento = '';
                document.getElementById('signatureInfo').style.display = 'none';
                verificarLiberacao();
                console.log('Sistema resetado');
            }
        };

        console.log('Sistema CAS-DF carregado. Use CAS_DEBUG para troubleshooting.');
    </script>
</body>
</html>
